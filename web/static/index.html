<!DOCTYPE html>
<html lang="zh-CN">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>ËøêÁª¥ÊñáÊ°£ÁîüÊàêÁ≥ªÁªü</title>
    <link rel="stylesheet" href="/static/style.css">
</head>
<body>
    <div class="container">
        <header>
            <h1>ËøêÁª¥ÊñáÊ°£ÁîüÊàêÁ≥ªÁªü</h1>
        </header>

        <main>
            <!-- ÈÖçÁΩÆÂå∫Âüü -->
            <section class="config-bar">
                <div class="config-item">
                    <label>ÂÆ¢Êà∑ÈÖçÁΩÆ</label>
                    <select id="clientSelect">
                        <option value="">Âä†ËΩΩ‰∏≠...</option>
                    </select>
                </div>
                <div class="config-item">
                    <label>ÂÆ¢Êà∑ÂêçÁß∞</label>
                    <input type="text" id="clientNameInput" placeholder="ÂèØÈÄâÔºåË¶ÜÁõñÈªòËÆ§ÂêçÁß∞">
                </div>
                <div class="config-item">
                    <label>ËæìÂá∫Ê†ºÂºè</label>
                    <select id="formatSelect">
                        <option value="word" selected>Word (.docx)</option>
                        <option value="pdf">PDF (.pdf)</option>
                    </select>
                </div>
                <button id="generateAllBtn" class="btn btn-primary" disabled>
                    <span class="btn-text">ÂÖ®ÈÉ®ÁîüÊàê</span>
                    <span class="btn-loading" style="display:none;">ÁîüÊàê‰∏≠...</span>
                </button>
                <button id="newConfigBtn" class="btn btn-secondary" onclick="showConfigModal()">
                    <span class="btn-text">+ Êñ∞Âª∫ÈÖçÁΩÆ</span>
                </button>
            </section>

            <!-- ÊñáÊ°£ÂàóË°® -->
            <section class="doc-list">
                <div class="list-header">
                    <span>ÊñáÊ°£Á±ªÂûã</span>
                    <span>Êìç‰Ωú</span>
                </div>
                <div id="docList" class="list-body">
                    <div class="list-empty">ËØ∑ÂÖàÈÄâÊã©ÂÆ¢Êà∑ÈÖçÁΩÆ</div>
                </div>
            </section>

            <!-- ÁîüÊàêÁªìÊûú -->
            <section id="resultSection" class="result-section" style="display:none;">
                <div class="result-header">
                    <span>üì¶ Â∑≤ÁîüÊàêÊñáÊ°£</span>
                    <button id="downloadAllBtn" class="btn btn-success btn-sm">ÊâìÂåÖ‰∏ãËΩΩ</button>
                </div>
                <div id="resultList" class="result-list"></div>
            </section>
        </main>

        <footer>
            <p>ËøêÁª¥ÊñáÊ°£ÁîüÊàêÁ≥ªÁªü</p>
        </footer>
    </div>

    <!-- Êñ∞Âª∫/ÁºñËæëÈÖçÁΩÆÊ®°ÊÄÅÊ°Ü -->
    <div id="configModal" class="modal" style="display:none;">
        <div class="modal-content modal-lg">
            <div class="modal-header">
                <h2 id="modalTitle">Êñ∞Âª∫ÈÖçÁΩÆ</h2>
                <button class="modal-close" onclick="hideConfigModal()">&times;</button>
            </div>
            <div class="modal-body">
                <form id="configForm">
                    <!-- Âü∫Êú¨‰ø°ÊÅØ -->
                    <div class="form-row">
                        <div class="form-group">
                            <label for="cfgClientName">ÂÆ¢Êà∑ÂêçÁß∞ *</label>
                            <input type="text" id="cfgClientName" placeholder="‰æãÂ¶ÇÔºöXXÂÖ¨Âè∏" required>
                        </div>
                        <div class="form-group">
                            <label for="cfgDocTypeName">ÊñáÊ°£Á±ªÂûãÂêçÁß∞ *</label>
                            <input type="text" id="cfgDocTypeName" placeholder="‰æãÂ¶ÇÔºöËøêÁª¥ÊâãÂÜå" required>
                        </div>
                    </div>
                    <div class="form-row">
                        <div class="form-group">
                            <label for="cfgOutputPattern">ËæìÂá∫Êñá‰ª∂ÂêçÊ®°Âºè</label>
                            <input type="text" id="cfgOutputPattern" placeholder="{client}_{title}_{date}">
                            <small class="form-hint">ÊîØÊåÅ: {client}, {title}, {version}, {date}ÔºàÊâ©Â±ïÂêçËá™Âä®Ê∑ªÂä†Ôºâ</small>
                        </div>
                    </div>

                    <!-- Tab ÂØºËà™ -->
                    <div class="config-tabs">
                        <button type="button" class="tab-btn active" data-tab="tabGeneral">ÈÄöÁî®ËÆæÁΩÆ</button>
                        <button type="button" class="tab-btn" data-tab="tabWord">Word ËÆæÁΩÆ</button>
                        <button type="button" class="tab-btn" data-tab="tabPdf">PDF ËÆæÁΩÆ</button>
                        <button type="button" class="tab-btn" data-tab="tabModules">ÊñáÊ°£Ê®°Âùó</button>
                    </div>

                    <!-- Tab ÂÜÖÂÆπÔºöÈÄöÁî®ËÆæÁΩÆ -->
                    <div id="tabGeneral" class="tab-content active">
                        <div class="pandoc-args-section">
                            <div class="args-category">
                                <h4>Âü∫Á°ÄËÆæÁΩÆ</h4>
                                <div class="checkbox-group">
                                    <label class="checkbox-label">
                                        <input type="checkbox" id="argToc" checked> --toc (ÁîüÊàêÁõÆÂΩï)
                                    </label>
                                    <label class="checkbox-label">
                                        <input type="checkbox" id="argNumberSections" checked> --number-sections (Á´†ËäÇÁºñÂè∑)
                                    </label>
                                    <label class="checkbox-label">
                                        <input type="checkbox" id="argStandalone" checked> --standalone (Áã¨Á´ãÊñáÊ°£)
                                    </label>
                                    <label class="checkbox-label">
                                        <input type="checkbox" id="argFileScope"> --file-scope (Êñá‰ª∂Áã¨Á´ãÂ§ÑÁêÜ)
                                    </label>
                                    <label class="checkbox-label">
                                        <input type="checkbox" id="argPreserveTabs"> --preserve-tabs (‰øùÁïôTab)
                                    </label>
                                    <label class="checkbox-label">
                                        <input type="checkbox" id="argStripComments"> --strip-comments (ÁßªÈô§Ê≥®Èáä)
                                    </label>
                                </div>
                            </div>
                            <div class="args-category">
                                <h4>ÁõÆÂΩïËÆæÁΩÆ</h4>
                                <div class="args-row">
                                    <label for="argTocDepth">ÁõÆÂΩïÊ∑±Â∫¶</label>
                                    <select id="argTocDepth">
                                        <option value="">ÈªòËÆ§(3)</option>
                                        <option value="1">1Á∫ß</option>
                                        <option value="2">2Á∫ß</option>
                                        <option value="3">3Á∫ß</option>
                                        <option value="4">4Á∫ß</option>
                                        <option value="5">5Á∫ß</option>
                                        <option value="6">6Á∫ß</option>
                                    </select>
                                </div>
                            </div>
                            <div class="args-category">
                                <h4>Ê†áÈ¢òËÆæÁΩÆ</h4>
                                <div class="args-row">
                                    <label for="argShiftHeading">Ê†áÈ¢òÁ∫ßÂà´ÂÅèÁßª</label>
                                    <select id="argShiftHeading">
                                        <option value="">‰∏çÂÅèÁßª</option>
                                        <option value="-2">-2 (ÊèêÂçá2Á∫ß)</option>
                                        <option value="-1">-1 (ÊèêÂçá1Á∫ß)</option>
                                        <option value="1">+1 (Èôç‰Ωé1Á∫ß)</option>
                                        <option value="2">+2 (Èôç‰Ωé2Á∫ß)</option>
                                    </select>
                                </div>
                                <div class="args-row">
                                    <label for="argTopLevelDiv">È°∂Á∫ßÂàÜÂå∫Á±ªÂûã</label>
                                    <select id="argTopLevelDiv">
                                        <option value="">ÈªòËÆ§</option>
                                        <option value="section">section</option>
                                        <option value="chapter">chapter</option>
                                        <option value="part">part</option>
                                    </select>
                                </div>
                            </div>
                            <div class="args-category">
                                <h4>‰ª£Á†ÅÈ´ò‰∫Æ</h4>
                                <div class="args-row">
                                    <label for="argHighlightStyle">È´ò‰∫ÆÊ†∑Âºè</label>
                                    <select id="argHighlightStyle">
                                        <option value="">ÈªòËÆ§(pygments)</option>
                                        <option value="pygments">pygments</option>
                                        <option value="kate">kate</option>
                                        <option value="monochrome">monochrome</option>
                                        <option value="espresso">espresso</option>
                                        <option value="zenburn">zenburn</option>
                                        <option value="haddock">haddock</option>
                                        <option value="tango">tango</option>
                                        <option value="breezedark">breezedark</option>
                                    </select>
                                </div>
                                <label class="checkbox-label" style="margin-top:8px;">
                                    <input type="checkbox" id="argNoHighlight"> --no-highlight (Á¶ÅÁî®‰ª£Á†ÅÈ´ò‰∫Æ)
                                </label>
                            </div>
                            <div class="args-category">
                                <h4>ÊñáÊú¨Ê†ºÂºè</h4>
                                <div class="args-row">
                                    <label for="argWrap">ÊñáÊú¨Êç¢Ë°å</label>
                                    <select id="argWrap">
                                        <option value="">ÈªòËÆ§(auto)</option>
                                        <option value="auto">auto</option>
                                        <option value="none">none (‰∏çÊç¢Ë°å)</option>
                                        <option value="preserve">preserve (‰øùÁïôÂéüÊ†∑)</option>
                                    </select>
                                </div>
                                <div class="args-row">
                                    <label for="argColumns">Êç¢Ë°åÂàóÊï∞</label>
                                    <input type="number" id="argColumns" placeholder="ÈªòËÆ§72" min="20" max="200">
                                </div>
                                <div class="args-row">
                                    <label for="argTabStop">TabÂÆΩÂ∫¶</label>
                                    <select id="argTabStop">
                                        <option value="">ÈªòËÆ§(4)</option>
                                        <option value="2">2</option>
                                        <option value="4">4</option>
                                        <option value="8">8</option>
                                    </select>
                                </div>
                            </div>
                        </div>
                        <div class="form-group" style="margin-top: 12px;">
                            <label for="cfgCustomArgs">ÂÖ∂‰ªñËá™ÂÆö‰πâÂèÇÊï∞</label>
                            <input type="text" id="cfgCustomArgs" placeholder="‰æãÂ¶Ç: --metadata=key:value">
                            <small class="form-hint">Áî®Á©∫Ê†ºÂàÜÈöîÂ§ö‰∏™ÂèÇÊï∞</small>
                        </div>
                    </div>

                    <!-- Tab ÂÜÖÂÆπÔºöWord ËÆæÁΩÆ -->
                    <div id="tabWord" class="tab-content">
                        <div class="format-settings">
                            <div class="args-category">
                                <h4>Word Ê®°Êùø</h4>
                                <div class="form-group">
                                    <label for="cfgTemplate">ÈÄâÊã©Ê®°Êùø</label>
                                    <select id="cfgTemplate">
                                        <option value="">‰ΩøÁî®ÈªòËÆ§Ê®°Êùø</option>
                                    </select>
                                    <small class="form-hint">Word Â≠ó‰ΩìÊ†∑ÂºèÁî±Ê®°ÊùøÊñá‰ª∂ÊéßÂà∂Ôºå‰øÆÊîπ templates/default.docx ‰∏≠ÁöÑÊ†∑Âºè</small>
                                </div>
                            </div>
                            <div class="args-category">
                                <h4>ËØ¥Êòé</h4>
                                <p class="info-text">Word ÊñáÊ°£ÁöÑÂ≠ó‰Ωì„ÄÅÊ†∑Âºè„ÄÅÈ°µÁúâÈ°µËÑöÁ≠âÁî±Ê®°ÊùøÊñá‰ª∂ (.docx) ÊéßÂà∂„ÄÇ</p>
                                <p class="info-text">Â¶ÇÈúÄËá™ÂÆö‰πâÊ†∑ÂºèÔºö</p>
                                <ol class="info-list">
                                    <li>ÊâìÂºÄ templates/default.docx</li>
                                    <li>‰øÆÊîπ"Ê†∑Âºè"‰∏≠ÁöÑÂ≠ó‰Ωì„ÄÅÂ§ßÂ∞è„ÄÅÈ¢úËâ≤Á≠â</li>
                                    <li>‰øùÂ≠òÊ®°ÊùøÊñá‰ª∂</li>
                                </ol>
                            </div>
                        </div>
                    </div>

                    <!-- Tab ÂÜÖÂÆπÔºöPDF ËÆæÁΩÆ -->
                    <div id="tabPdf" class="tab-content">
                        <div class="format-settings">
                            <div class="pdf-settings-grid">
                                <!-- Â≠ó‰ΩìËÆæÁΩÆ -->
                                <div class="args-category">
                                    <h4>Â≠ó‰ΩìËÆæÁΩÆ</h4>
                                    <div class="args-row">
                                        <label for="pdfMainFont">Ê≠£ÊñáÂ≠ó‰Ωì</label>
                                        <select id="pdfMainFont">
                                            <option value="">ÈªòËÆ§</option>
                                            <option value="Microsoft YaHei" selected>ÂæÆËΩØÈõÖÈªë</option>
                                            <option value="SimSun">ÂÆã‰Ωì</option>
                                            <option value="SimHei">Èªë‰Ωì</option>
                                            <option value="KaiTi">Ê•∑‰Ωì</option>
                                            <option value="FangSong">‰ªøÂÆã</option>
                                            <option value="Noto Sans SC">Noto Sans SC</option>
                                            <option value="Noto Serif SC">Noto Serif SC</option>
                                            <option value="Source Han Sans SC">ÊÄùÊ∫êÈªë‰Ωì</option>
                                        </select>
                                    </div>
                                    <div class="args-row">
                                        <label for="pdfMonoFont">‰ª£Á†ÅÂ≠ó‰Ωì</label>
                                        <select id="pdfMonoFont">
                                            <option value="">ÈªòËÆ§</option>
                                            <option value="Consolas" selected>Consolas</option>
                                            <option value="Courier New">Courier New</option>
                                            <option value="Source Code Pro">Source Code Pro</option>
                                            <option value="Fira Code">Fira Code</option>
                                        </select>
                                    </div>
                                    <div class="args-row">
                                        <label for="pdfFontSize">Â≠ó‰ΩìÂ§ßÂ∞è</label>
                                        <select id="pdfFontSize">
                                            <option value="">ÈªòËÆ§(11pt)</option>
                                            <option value="10pt">10pt</option>
                                            <option value="11pt">11pt</option>
                                            <option value="12pt">12pt</option>
                                        </select>
                                    </div>
                                    <div class="args-row">
                                        <label for="pdfLineStretch">Ë°åÈó¥Ë∑ù</label>
                                        <select id="pdfLineStretch">
                                            <option value="">ÈªòËÆ§(1.0)</option>
                                            <option value="1.0">1.0</option>
                                            <option value="1.15">1.15</option>
                                            <option value="1.25">1.25</option>
                                            <option value="1.5">1.5</option>
                                            <option value="2.0">2.0</option>
                                        </select>
                                    </div>
                                </div>
                                <!-- Â∞ÅÈù¢ËÆæÁΩÆ -->
                                <div class="args-category">
                                    <h4>Â∞ÅÈù¢ËÆæÁΩÆ</h4>
                                    <label class="checkbox-label">
                                        <input type="checkbox" id="pdfTitlePage" checked> ÂêØÁî®Â∞ÅÈù¢
                                    </label>
                                    <div class="args-row">
                                        <label for="pdfTitleBgColor">Â∞ÅÈù¢ËÉåÊôØËâ≤</label>
                                        <input type="color" id="pdfTitleBgColor" value="#2C3E50">
                                    </div>
                                    <div class="args-row">
                                        <label for="pdfTitleTextColor">Â∞ÅÈù¢ÊñáÂ≠óËâ≤</label>
                                        <input type="color" id="pdfTitleTextColor" value="#FFFFFF">
                                    </div>
                                    <div class="args-row">
                                        <label for="pdfTitleRuleColor">Ë£ÖÈ•∞Á∫øÈ¢úËâ≤</label>
                                        <input type="color" id="pdfTitleRuleColor" value="#3498DB">
                                    </div>
                                </div>
                                <!-- È°µÈù¢ËÆæÁΩÆ -->
                                <div class="args-category">
                                    <h4>È°µÈù¢ËÆæÁΩÆ</h4>
                                    <div class="args-row">
                                        <label for="pdfGeometry">È°µËæπË∑ù</label>
                                        <select id="pdfGeometry">
                                            <option value="">ÈªòËÆ§</option>
                                            <option value="margin=2cm">2cm</option>
                                            <option value="margin=2.5cm" selected>2.5cm</option>
                                            <option value="margin=3cm">3cm</option>
                                            <option value="margin=1in">1Ëã±ÂØ∏</option>
                                        </select>
                                    </div>
                                    <div class="args-row">
                                        <label for="pdfPaperSize">Á∫∏Âº†Â§ßÂ∞è</label>
                                        <select id="pdfPaperSize">
                                            <option value="">ÈªòËÆ§(A4)</option>
                                            <option value="a4paper">A4</option>
                                            <option value="letterpaper">Letter</option>
                                            <option value="a5paper">A5</option>
                                        </select>
                                    </div>
                                    <label class="checkbox-label">
                                        <input type="checkbox" id="pdfTocOwnPage" checked> ÁõÆÂΩïÂçïÁã¨‰∏ÄÈ°µ
                                    </label>
                                </div>
                                <!-- ÈìæÊé•ËÆæÁΩÆ -->
                                <div class="args-category">
                                    <h4>ÈìæÊé•ËÆæÁΩÆ</h4>
                                    <label class="checkbox-label">
                                        <input type="checkbox" id="pdfColorLinks" checked> ÂΩ©Ëâ≤ÈìæÊé•
                                    </label>
                                    <div class="args-row">
                                        <label for="pdfLinkColor">ÈìæÊé•È¢úËâ≤</label>
                                        <input type="color" id="pdfLinkColor" value="#2980B9">
                                    </div>
                                    <div class="args-row">
                                        <label for="pdfUrlColor">URLÈ¢úËâ≤</label>
                                        <input type="color" id="pdfUrlColor" value="#3498DB">
                                    </div>
                                </div>
                                <!-- ‰ª£Á†ÅÂùóËÆæÁΩÆ -->
                                <div class="args-category">
                                    <h4>‰ª£Á†ÅÂùóËÆæÁΩÆ</h4>
                                    <label class="checkbox-label">
                                        <input type="checkbox" id="pdfListings" checked> ‰ΩøÁî® listings ÂåÖ
                                    </label>
                                    <label class="checkbox-label">
                                        <input type="checkbox" id="pdfListingsNoBreak" checked> ‰ª£Á†ÅÂùó‰∏çË∑®È°µ
                                    </label>
                                    <div class="args-row">
                                        <label for="pdfCodeFontSize">‰ª£Á†ÅÂ≠ó‰ΩìÂ§ßÂ∞è</label>
                                        <select id="pdfCodeFontSize">
                                            <option value="">ÈªòËÆ§</option>
                                            <option value="\\tiny">tiny</option>
                                            <option value="\\scriptsize">scriptsize</option>
                                            <option value="\\footnotesize">footnotesize</option>
                                            <option value="\\small" selected>small</option>
                                            <option value="\\normalsize">normalsize</option>
                                        </select>
                                    </div>
                                </div>
                                <!-- È°µÁúâÈ°µËÑö -->
                                <div class="args-category">
                                    <h4>È°µÁúâÈ°µËÑö</h4>
                                    <div class="args-row">
                                        <label for="pdfHeaderLeft">Â∑¶È°µÁúâ</label>
                                        <select id="pdfHeaderLeft">
                                            <option value="">Êó†</option>
                                            <option value="\\leftmark" selected>Á´†ËäÇÂêç</option>
                                            <option value="\\rightmark">Â∞èËäÇÂêç</option>
                                        </select>
                                    </div>
                                    <div class="args-row">
                                        <label for="pdfHeaderRight">Âè≥È°µÁúâ</label>
                                        <select id="pdfHeaderRight">
                                            <option value="">Êó†</option>
                                            <option value="\\thepage" selected>È°µÁ†Å</option>
                                            <option value="\\leftmark">Á´†ËäÇÂêç</option>
                                        </select>
                                    </div>
                                </div>
                            </div>
                        </div>
                    </div>

                    <!-- Tab ÂÜÖÂÆπÔºöÊñáÊ°£Ê®°Âùó -->
                    <div id="tabModules" class="tab-content">
                        <div class="form-group">
                            <label>ÈÄâÊã©ÊñáÊ°£Ê®°Âùó * <small>(ÊãñÊãΩÊéíÂ∫è)</small></label>
                            <div id="moduleList" class="module-list">
                                <div class="list-empty">Âä†ËΩΩ‰∏≠...</div>
                            </div>
                        </div>
                    </div>

                    <div class="form-group" style="margin-top: 15px;">
                        <label>Êñá‰ª∂ÂêçÈ¢ÑËßà</label>
                        <div id="filenamePreview" class="filename-preview">-</div>
                    </div>
                </form>
            </div>
            <div class="modal-footer">
                <button type="button" class="btn btn-secondary" onclick="hideConfigModal()">ÂèñÊ∂à</button>
                <button type="button" class="btn btn-primary" onclick="submitConfig()">
                    <span class="btn-text">‰øùÂ≠òÈÖçÁΩÆ</span>
                    <span class="btn-loading" style="display:none;">‰øùÂ≠ò‰∏≠...</span>
                </button>
            </div>
        </div>
    </div>

    <!-- Á°ÆËÆ§Âà†Èô§ÂØπËØùÊ°Ü -->
    <div id="confirmModal" class="modal" style="display:none;">
        <div class="modal-content modal-sm">
            <div class="modal-header">
                <h2>Á°ÆËÆ§Âà†Èô§</h2>
                <button class="modal-close" onclick="hideConfirmModal()">&times;</button>
            </div>
            <div class="modal-body">
                <p id="confirmMessage">Á°ÆÂÆöË¶ÅÂà†Èô§Ê≠§ÈÖçÁΩÆÂêóÔºü</p>
            </div>
            <div class="modal-footer">
                <button type="button" class="btn btn-secondary" onclick="hideConfirmModal()">ÂèñÊ∂à</button>
                <button type="button" class="btn btn-danger" id="confirmDeleteBtn">Âà†Èô§</button>
            </div>
        </div>
    </div>

    <script src="/static/app.js"></script>
</body>
</html>
